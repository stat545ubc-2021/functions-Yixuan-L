---
title: "Assignment-1"
author: "Yixuan Li(61261814)"
date: "03/11/2021"
output: github_document
---

### Exercise 1&2: Make a function and document your function ###

#### Load packages ####

```{r chunk1, message=FALSE, warning=FALSE}
library(tibble)
library(dplyr)
library(tidyr)
library(datateachr)
library(testthat)
library(splitstackshape)
```

#### Function for summary statistics  ####

I make a function to summarize statistics (mean, lowest, highest, std, median) of a numeric column within a category column in a dataset.

```{r chunk2}
#' @title Summary Statistics of a numeric column within a category column in a dataset
#' @description This function outputs mean, lowest value, highest value, std, median summary statistics for a numeric column grouped by a category. 
#' @params dataset, the dataset.
#' @params category, the category which can be divided into several types, and then we will summarize a numeric column grouped by this category.
#' @params column, the numeric column for computing summary statistics.
#' @return A tibble of the summary statistics.
 
Function1 <- function(dataset, category, column) {
# make sure the class of dataset should be dataframe
  if(!is.data.frame(dataset)) {
    stop("Error: type of dataset must be dataframe rather than:", class(dataset)[1], "please input again")}
# make sure the class of column should be numeric
  flg <- summarise(dataset, is.numeric({{ column }}))
  if (!flg[[1]]) {
     stop("Error: type of column must be numeric, please input again")}


result <- dataset %>%
# filter none values for column
  filter(!is.na({{ column }})) %>%
# group by category
  group_by({{ category }}) %>%
# summarize for mean, lowest, highest, std, median of column
  summarise(
    mean.col = mean({{ column }}, na.rm = TRUE),
    lowest.col = range({{ column }})[1],
    highest.col = range({{ column }})[2],
    std.col = sd({{ column }}, na.rm = TRUE),
    median.col = median({{ column }}, na.rm = TRUE)
  )
# print the result with tibble format
print(result)

 }
```

### Exercise 3: Include Examples ###

The original summary statistics code without using function. This code is going to summarize `no_of_storeys` for each `property_type` of `apt_buildings` dataset.

```{r chunk3}
storeys_stat <- apt_buildings %>%
  filter(!is.na(no_of_storeys)) %>%
  group_by(property_type) %>%
  summarise(
    mean.storey = mean(no_of_storeys, na.rm = TRUE),
    lowest.storey = range(no_of_storeys)[1],
    highest.storey = range(no_of_storeys)[2],
    std.storey = sd(no_of_storeys, na.rm = TRUE),
    median.storey = median(no_of_storeys, na.rm = TRUE)
  )
print(storeys_stat)
```
Example: With the `Function1`, this code is going to print out the same summary information as chunk3.
```{r chunk4}
Function1(apt_buildings, property_type, no_of_storeys)
```
Example: With the `Function1`, this code is going to print out the summary information of `year_built` for different `air_conditioning` types of `apt_buildings` dataset.

```{r chunk5}
Function1(apt_buildings, air_conditioning, year_built)
```
Example: With the `Function1`, this code is going to print out the summary information of `year_built` for different `window_type` types of `apt_buildings` dataset.
```{r chunk6}
Function1(apt_buildings, window_type, year_built)
```

### Exercise 4: Test the Function ###

Test1: If for parameter `dataset`, we input a parameter not in dataframe type, it will throw an error.
```{r chunk7}
test_that("Test 1", {
expect_error(Function1('apt_buildings', property_type, year_built)) })
```

Test2: If for parameter `column`, we input a parameter not in numeric type, it will throw an error.
```{r chunk8}
test_that("Test 2", {
expect_error(Function1(apt_buildings, property_type, air_conditioning)) })
```

Test3: Confirm whether the output format of the function is dataframe(tibble).
```{r chunk9}
test_that("Test 3", {
  Func <- Function1(apt_buildings, property_type, year_built)
  expect_true(is.data.frame(Func))
})

```